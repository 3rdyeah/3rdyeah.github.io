## 怎么保证消息顺序

使用消息队列，并对消息的收发者使用 hash 分配消息的收发队列，同一个发送者或者接受者只从同一个队列收发消息

## 如果客户端接受服务器返回的消息失败，无限尝试重发消息，怎么处理

在服务器存储一个针对当前客户端的唯一消息 id，客户端初次连接返回给客户端，每次客户端向服务器发送消息都要带上这个唯一 id，每次服务器接到客户端消息后都要更新这个唯一 id 并返回给客户端